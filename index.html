<!DOCTYPE html>
<html lang="sl">
<head>
  <meta charset="UTF-8">
  <title>TV Arhiv - Radio Marija</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    * { box-sizing: border-box; }
    body {
      font-family: 'Segoe UI', sans-serif;
      margin: 0;
      background: #f4f6fb;
      color: #333;
    }
    header, footer {
      background: #2e3a59;
      color: white;
      padding: 10px 20px;
    }
    header {
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    header img { height: 40px; }
    nav a {
      color: white;
      margin-left: 15px;
      text-decoration: none;
      font-weight: bold;
    }
    .content {
      padding: 30px;
      display: none;
    }
    table {
      width: 100%;
      background: white;
      border-collapse: collapse;
      box-shadow: 0 4px 10px rgba(0,0,0,0.05);
    }
    th, td {
      padding: 12px 15px;
      border: 1px solid #e0e0e0;
    }
    th {
      background: #f0f2f7;
      text-align: left;
    }
    button {
      background: #2e77d0;
      color: white;
      padding: 10px 20px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-weight: bold;
      margin-top: 20px;
    }
    footer {
      text-align: center;
      position: fixed;
      bottom: 0;
      width: 100%;
    }
    .modal, .login-screen {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.5);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 10;
    }
    .modal-content, .login-box {
      background: white;
      padding: 20px;
      border-radius: 10px;
      width: 90%;
      max-width: 500px;
      box-shadow: 0 5px 15px rgba(0,0,0,0.2);
      position: relative;
    }
    .login-box img {
      display: block;
      margin: 0 auto 20px;
      max-width: 80%;
    }
    .login-box input {
      width: 100%;
      padding: 10px;
      margin-bottom: 15px;
      border-radius: 5px;
      border: 1px solid #ccc;
    }
    .close {
      position: absolute;
      top: 10px; right: 15px;
      font-size: 18px;
      cursor: pointer;
      color: #aaa;
    }
    .close:hover { color: black; }
    .status { margin-top: 10px; }
    .status label { display: block; margin-bottom: 5px; }
    .delete-btn { cursor: pointer; color: red; }
  </style>
</head>
<body>

<header>
  <img src="RMS.png" alt="RMS Logo">
  <nav>
    <a href="#" onclick="prikaziDomov()">DOMOV</a>
    <a href="#" onclick="prikaziArhiv()">ARHIV</a>
    <a href="#" onclick="odjava()">ODJAVA</a>
  </nav>
</header>

<div class="content" id="domov">
  <div style="text-align:center;">
    <img src="RMS.png" alt="Logo" style="max-width:300px;">
  </div>
</div>

<div class="content" id="arhiv">
  <h2>Arhiv scenarijev</h2>
  <button onclick="odpriModal()">+ Dodaj scenarij</button>
  <table id="tabela">
    <thead>
      <tr>
        <th>Datum</th>
        <th>Naslov</th>
        <th>Tip</th>
        <th>Jezik</th>
        <th>Stanje</th>
        <th>Brisanje</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
</div>

<footer>
  ¬© Radio Marija Slovenija, 2025
</footer>

<div id="modal" class="modal" style="display:none;">
  <div class="modal-content">
    <span class="close" onclick="zapriModal()">&times;</span>
    <h3>Dodaj nov scenarij</h3>
    <input type="date" id="datum">
    <input type="text" id="naslov" placeholder="Naslov oddaje" />
    <select id="tip">
      <option value="prevod">Prevod</option>
      <option value="podnapisi">Podnapisi</option>
      <option value="voice-over">Voice-over</option>
    </select>
    <input type="text" id="jezik" placeholder="Jezik" />
    <input type="file" id="scenarijFile" accept=".doc,.docx">
    <select id="stanje">
      <option value="PREVEDENO">PREVEDENO</option>
      <option value="POSNETO">POSNETO</option>
      <option value="UREJENO">UREJENO</option>
      <option value="OBJAVLJENO">OBJAVLJENO</option>
    </select>
    <button onclick="shraniScenarij()">Shrani scenarij</button>
  </div>
</div>

<div class="login-screen" id="login">
  <div class="login-box">
    <img src="RMS.png" alt="RMS">
    <h3 style="text-align:center;">Prijava</h3>
    <input type="text" id="uporabniskoIme" placeholder="Uporabni≈°ko ime (npr. neja)">
    <button onclick="prijava()">Prijavi se</button>
  </div>
</div>

<script>
const dovoljeni = {
  "jasa": "Ja≈°a Petrinjak",
  "neja": "Neja Stvarnik",
  "julija": "Julija Brilej"
};

let prijavljen = null;

function prijava() {
  const vnos = document.getElementById("uporabniskoIme").value.toLowerCase().trim();
  if (dovoljeni[vnos]) {
    prijavljen = dovoljeni[vnos];
    localStorage.setItem("prijavljen", prijavljen);
    document.getElementById("login").style.display = "none";
    document.getElementById("domov").style.display = "block";
  } else {
    alert("Neveljavno uporabni≈°ko ime.");
  }
}

function odjava() {
  localStorage.removeItem("prijavljen");
  location.reload();
}

function odpriModal() {
  document.getElementById("modal").style.display = "flex";
}

function zapriModal() {
  document.getElementById("modal").style.display = "none";
}

function shraniScenarij() {
  const datum = document.getElementById("datum").value;
  const naslov = document.getElementById("naslov").value;
  const tip = document.getElementById("tip").value;
  const jezik = document.getElementById("jezik").value;
  const stanje = document.getElementById("stanje").value;
  const file = document.getElementById("scenarijFile").files[0];

  if (!datum || !naslov || !jezik || !file) {
    alert("Izpolni vsa polja in nalo≈æi datoteko.");
    return;
  }

  const reader = new FileReader();
  reader.onload = function(e) {
    const url = e.target.result;
    let podatki = JSON.parse(localStorage.getItem("arhiv") || "[]");
    podatki.push({ datum, naslov, tip, jezik, stanje, dodal: prijavljen, fileName: file.name, fileUrl: url });
    localStorage.setItem("arhiv", JSON.stringify(podatki));
    zapriModal();
    prikaziArhiv();
  };
  reader.readAsDataURL(file);
}

function prikaziArhiv() {
  document.getElementById("domov").style.display = "none";
  document.getElementById("arhiv").style.display = "block";
  const podatki = JSON.parse(localStorage.getItem("arhiv") || "[]");
  const tbody = document.querySelector("#tabela tbody");
  tbody.innerHTML = "";
  podatki.forEach((p, i) => {
    const tr = document.createElement("tr");
    const naslovLink = `<a href="#" onclick='odpriPodrobnosti(${i})'>${p.naslov}</a>`;
    tr.innerHTML = `
      <td>${p.datum}</td>
      <td>${naslovLink}</td>
      <td>${p.tip}</td>
      <td>${p.jezik}</td>
      <td>${p.stanje}</td>
      <td><span class="delete-btn" onclick="izbrisi(${i})">üóëÔ∏è</span></td>
    `;
    tbody.appendChild(tr);
  });
}

function izbrisi(index) {
  let podatki = JSON.parse(localStorage.getItem("arhiv") || "[]");
  podatki.splice(index, 1);
  localStorage.setItem("arhiv", JSON.stringify(podatki));
  prikaziArhiv();
}

function odpriPodrobnosti(index) {
  const podatki = JSON.parse(localStorage.getItem("arhiv") || "[]");
  const p = podatki[index];
  alert(`Scenarij: ${p.naslov}\nDatum: ${p.datum}\nStanje: ${p.stanje}\nAvtor: ${p.dodal}\nPrenos: ${p.fileName}`);
  window.open(p.fileUrl, '_blank');
}

function prikaziDomov() {
  document.getElementById("arhiv").style.display = "none";
  document.getElementById("domov").style.display = "block";
}

window.onload = () => {
  const uporabnik = localStorage.getItem("prijavljen");
  if (uporabnik && Object.values(dovoljeni).includes(uporabnik)) {
    prijavljen = uporabnik;
    document.getElementById("login").style.display = "none";
    document.getElementById("domov").style.display = "block";
  }
};
</script>

</body>
</html>
